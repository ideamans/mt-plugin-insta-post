# InstaPost Movable Type プラグイン

このプラグインは、InstagramのリアルタイムAPIを用い、Instagramに写真が投稿されたとタイミングでブログ記事を作成します。

## 対応環境

* Movable Type 6.0x
* PSGI環境にも対応します

## インストール

次のファイルおよびディレクトリを、お使いのMovable Typeディレクトリにインストールします。

* plugins/InstaPost
* mt-insta-post.cgi

mt-insta-post.cgi ファイルには、mt.cgi ファイルと同様に、実行可能権限(0755など)を付与してください(CGI実行環境の場合)。

基本認証などにより、 mt-insta-post.cgi が、外部からアクセスできない状態にあると利用できません。

## セットアップ

### システム全体

最初の1回だけ実施します。

1. 管理者権限でシステム管理画面を開き、`設定` - `Webサービス` を開きます。
2. 案内にしたがって Instagram にアプリケーションを登録します。
3. クライアントIDとクライアントシークレットを入力して保存ボタンを押します。
4. サブスクリプションIDが取得できたら準備完了です。

### ユーザー

ユーザー各自で1回だけ実施します。

1. Instagramの写真を記事にしたいウェブサイトまたはブログを選択します。
2. メニューから `設定` - `Instagram投稿` を開きます。
3. `Instagramの認証を開始` ボタンを押すと、Instagramのログイン画面および、アプリケーションの認可画面に遷移します。
4. `OK` ボタンを押してアプリケーションを認可します。
5. Movable Type の管理画面に戻り、完了メッセージが表示されたら設定完了です。

## 使い方

### 投稿

Instagram に写真を投稿すると、選択したブログに記事が作成されます。

* 記事が作成されるとそのユーザーにメールが送信されます。
* 記事の作成時に、`下書き`の状態にするか、`公開`まで行うかを設定画面で選ぶことができます。

### Instagram ユーザーの変更や連携の解除

設定画面からは Instagram の再認証や、連携解除も行うことができます。

## 環境変数

* InstaPostMailSilent 1に設定すると、投稿後などの確認や完了のメールを送信しません。

